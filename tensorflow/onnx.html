<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONNX</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-F3w7mX95PdgyTmZZMECAngseQB83DfGTowi0iMjiWaeVhAn4FJkqJByhZMI3AhiU" crossorigin="anonymous">
</head>

<body class="d-flex flex-column h-100">
    <header>
        <nav class="navbar navbar-expand-md navbar-dark bg-dark">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">ONNX</a>
            </div>
        </nav>
    </header>
    <main>
        <section class="py-5 text-center container">
            <div class="row py-lg-5">
                <div class="col-lg-6 col-md-8 mx-auto">
                    <button type="button" class="btn btn-primary btn-lg" id="btnPredict">Predict</button>
                </div>
                <p>
                <h1 id="txtResult"></h1>
                </p>
            </div>
        </section>
    </main>
    <!-- import ONNXRuntime Web from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/ort.min.js"></script>
    <script>
        const btn = document.getElementById('btnPredict');
        const input = document.getElementById('formInput');
        const result = document.getElementById('txtResult');

        btn.addEventListener('click', async () => {
            const values = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.00392157,0,0,0.05098039,0.28627451,0,0,0.00392157,0.01568627,0,0,0,0,0.00392157,0.00392157,0,0,0,0,0,0,0,0,0,0,0,0,0,0.01176471,0,0.14117647,0.53333333,0.49803922,0.24313725,0.21176471,0,0,0,0.00392157,0.01176471,0.01568627,0,0,0.01176471,0,0,0,0,0,0,0,0,0,0,0,0,0.02352941,0,0.4,0.8,0.69019608,0.5254902,
                            0.56470588,0.48235294,0.09019608,0,0,0,0,0.04705882,0.03921569,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.60784314,0.9254902,0.81176471,0.69803922,0.41960784,0.61176471,0.63137255,0.42745098,0.25098039,0.09019608,0.30196078,0.50980392,0.28235294,0.05882353,0,0,0,0,0,0,0,0,0,0,0,0.00392157,0,0.27058824,0.81176471,0.8745098,0.85490196,0.84705882,0.84705882,0.63921569,0.49803922,0.4745098,0.47843137,0.57254902,0.55294118,0.34509804,0.6745098,0.25882353,0,0,0,0,0,0,0,0,0,0.00392157,0.00392157,0.00392157,
                            0,0.78431373,0.90980392,0.90980392,0.91372549,0.89803922,0.8745098,0.8745098,0.84313725,0.83529412,0.64313725,0.49803922,0.48235294,0.76862745,0.89803922,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.71764706,0.88235294,0.84705882,0.8745098,0.89411765,0.92156863,0.89019608,0.87843137,0.87058824,0.87843137,0.86666667,0.8745098,0.96078431,0.67843137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.75686275,0.89411765,0.85490196,0.83529412,0.77647059,0.70588235,0.83137255,0.82352941,0.82745098,0.83529412,0.8745098,0.8627451,
                            0.95294118,0.79215686,0,0,0,0,0,0,0,0,0,0,0.00392157,0.01176471,0,0.04705882,0.85882353,0.8627451,0.83137255,0.85490196,0.75294118,0.6627451,0.89019608,0.81568627,0.85490196,0.87843137,0.83137255,0.88627451,0.77254902,0.81960784,0.20392157,0,0,0,0,0,0,0,0,0,0,0.02352941,0,0.38823529,0.95686275,0.87058824,0.8627451,0.85490196,0.79607843,0.77647059,0.86666667,0.84313725,0.83529412,0.87058824,0.8627451,0.96078431,0.46666667,0.65490196,0.21960784,0,0,0,0,0,0,0,0,0,0.01568627,0,0,0.21568627,
                            0.9254902,0.89411765,0.90196078,0.89411765,0.94117647,0.90980392,0.83529412,0.85490196,0.8745098,0.91764706,0.85098039,0.85098039,0.81960784,0.36078431,0,0,0,0.00392157,0.01568627,0.02352941,0.02745098,0.00784314,0,0,0,0,0,0.92941176,0.88627451,0.85098039,0.8745098,0.87058824,0.85882353,0.87058824,0.86666667,0.84705882,0.8745098,0.89803922,0.84313725,0.85490196,1,0.30196078,0,0,0.01176471,0,0,0,0,0,0,0,0.24313725,0.56862745,0.8,0.89411765,0.81176471,0.83529412,0.86666667,0.85490196,0.81568627,
                            0.82745098,0.85490196,0.87843137,0.8745098,0.85882353,0.84313725,0.87843137,0.95686275,0.62352941,0,0,0,0,0,0.07058824,0.17254902,0.32156863,0.41960784,0.74117647,0.89411765,0.8627451,0.87058824,0.85098039,0.88627451,0.78431373,0.80392157,0.82745098,0.90196078,0.87843137,0.91764706,0.69019608,0.7372549,0.98039216,0.97254902,0.91372549,0.93333333,0.84313725,0,0,0.22352941,0.73333333,0.81568627,0.87843137,0.86666667,0.87843137,0.81568627,0.8,0.83921569,0.81568627,0.81960784,0.78431373,0.62352941,
                            0.96078431,0.75686275,0.80784314,0.8745098,1,1,0.86666667,0.91764706,0.86666667,0.82745098,0.8627451,0.90980392,0.96470588,0,0.01176471,0.79215686,0.89411765,0.87843137,0.86666667,0.82745098,0.82745098,0.83921569,0.80392157,0.80392157,0.80392157,0.8627451,0.94117647,0.31372549,0.58823529,1,0.89803922,0.86666667,0.7372549,0.60392157,0.74901961,0.82352941,0.8,0.81960784,0.87058824,0.89411765,0.88235294,0,0.38431373,0.91372549,0.77647059,0.82352941,0.87058824,0.89803922,0.89803922,0.91764706,
                            0.97647059,0.8627451,0.76078431,0.84313725,0.85098039,0.94509804,0.25490196,0.28627451,0.41568627,0.45882353,0.65882353,0.85882353,0.86666667,0.84313725,0.85098039,0.8745098,0.8745098,0.87843137,0.89803922,0.11372549,0.29411765,0.8,0.83137255,0.8,0.75686275,0.80392157,0.82745098,0.88235294,0.84705882,0.7254902,0.77254902,0.80784314,0.77647059,0.83529412,0.94117647,0.76470588,0.89019608,0.96078431,0.9372549,0.8745098,0.85490196,0.83137255,0.81960784,0.87058824,0.8627451,0.86666667,0.90196078,
                            0.2627451,0.18823529,0.79607843,0.71764706,0.76078431,0.83529412,0.77254902,0.7254902,0.74509804,0.76078431,0.75294118,0.79215686,0.83921569,0.85882353,0.86666667,0.8627451,0.9254902,0.88235294,0.84705882,0.78039216,0.80784314,0.72941176,0.70980392,0.69411765,0.6745098,0.70980392,0.80392157,0.80784314,0.45098039,0,0.47843137,0.85882353,0.75686275,0.70196078,0.67058824,0.71764706,0.76862745,0.8,0.82352941,0.83529412,0.81176471,0.82745098,0.82352941,0.78431373,0.76862745,0.76078431,0.74901961,
                            0.76470588,0.74901961,0.77647059,0.75294118,0.69019608,0.61176471,0.65490196,0.69411765,0.82352941,0.36078431,0,0,0.29019608,0.74117647,0.83137255,0.74901961,0.68627451,0.6745098,0.68627451,0.70980392,0.7254902,0.7372549,0.74117647,0.7372549,0.75686275,0.77647059,0.8,0.81960784,0.82352941,0.82352941,0.82745098,0.7372549,0.7372549,0.76078431,0.75294118,0.84705882,0.66666667,0,0.00784314,0,0,0,0.25882353,0.78431373,0.87058824,0.92941176,0.9372549,0.94901961,0.96470588,0.95294118,0.95686275,
                            0.86666667,0.8627451,0.75686275,0.74901961,0.70196078,0.71372549,0.71372549,0.70980392,0.69019608,0.65098039,0.65882353,0.38823529,0.22745098,0,0,0,0,0,0,0,0,0,0.15686275,0.23921569,0.17254902,0.28235294,0.16078431,0.1372549,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]

            try {
                const session = await ort.InferenceSession.create('./save/model.onnx');
                const data = Float32Array.from(values);
                const tensor = new ort.Tensor('float32', data, [1, 28, 28, 1]);

                const results = await session.run({ input: tensor });
                const dataStr = results.Dense.data.toString();
                result.innerHTML = dataStr.replaceAll(',',"<br/>");
            } catch (e) {
                alert(`failed to inference ONNX model: ${e}.`);
            }
        });
    </script>
</body>

</html>